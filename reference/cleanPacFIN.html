<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Clean raw PacFIN data — cleanPacFIN • PacFIN.Utilities</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Clean raw PacFIN data — cleanPacFIN"><meta property="og:description" content="Clean raw PacFIN data to remove unsuitable samples if CLEAN = TRUE and
convert units of measured quantities to work with downstream functions.
Raw data are meant to be inclusive of everything from PacFIN so users can
explore all that is available, but this means that raw data will ALWAYS
include information that is not appropriate for use in
US West Coast stock assessments."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PacFIN.Utilities</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clean raw PacFIN data</h1>
    
    <div class="hidden name"><code>cleanPacFIN.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clean raw PacFIN data to remove unsuitable samples if <code>CLEAN = TRUE</code> and
convert units of measured quantities to work with downstream functions.
Raw data are meant to be inclusive of everything from PacFIN so users can
explore all that is available, but this means that raw data will <strong>ALWAYS</strong>
include information that is not appropriate for use in
US West Coast stock assessments.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cleanPacFIN</span><span class="op">(</span></span>
<span>  <span class="va">Pdata</span>,</span>
<span>  keep_INPFC <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">keep_gears</span>,</span>
<span>  keep_sample_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span>,</span>
<span>  keep_sample_method <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>  <span class="va">keep_length_type</span>,</span>
<span>  keep_age_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_missing_lengths <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  keep_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span><span class="op">)</span>,</span>
<span>  CLEAN <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  spp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">savedir</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Pdata</dt>
<dd><p>A data frame of biological samples
originating from the
Pacific Fishieries Information Network (PacFIN) data warehouse,
which originated in 2014. Data are pulled using sql calls, see
<code><a href="PullBDS.PacFIN.html">PullBDS.PacFIN</a>()</code>.</p></dd>


<dt>keep_INPFC</dt>
<dd><p><em>Deprecated</em>. Areas are now defined using different methods.</p></dd>


<dt>keep_gears</dt>
<dd><p>A character vector including only the gear types you want
to label as unique fleets. Order matters and will define fleet numbering.
If the argument is missing, which is the default, then all found gear groups
are maintained and ordered alphabetically. For more details see
<a href="getGearGroup.html">getGearGroup</a> that lists a web link for where you can find the
available gear groupings and how they link to <code>"GRID"</code> within your data.
GRID is a legacy term from PacFIN, now identified as
PACFIN_GEAR_CODE in the biological and fish ticket data, where
GR is short for gear and
ID is short for identification.
Typical entries will include character values such as <code>HKL</code>, <code>POT</code>, <code>TWL</code>,
where the latter is short for all non-shrimp trawls and
<code>TWS</code> is shrimp trawls.
Other gear identification codes and their definitions include
<code>DRG</code> which is dredge gear,
<code>MSC</code> which is all other miscellaneous gear such as diving or river trawls,
<code>NET</code> which is all non-trawl net gear,
<code>NTW</code> which is non-trawl gear, and
<code>TLS</code> which is trolling gear.
As a special case, <code>MID</code> is available for spiny dogfish to extract
mid-water trawl data as a separate fleet.</p></dd>


<dt>keep_sample_type</dt>
<dd><p>A vector of character values specifying the types of
samples you want to keep. The default is to keep <code>c("M")</code>. Available
types include market (M), research (R), special request (S), and
commercial on-board (C). There are additional samples without a <code>SAMPLE_TYPE</code>,
but they are only kept if you include <code>NA</code> in your call.
All sample types from California are assigned to <code>M</code>.
Including commercial on-board samples is not recommended because
they might also be in WCGOP data and would lead to double counting.</p></dd>


<dt>keep_sample_method</dt>
<dd><p>A vector of character values specifying the types of
sampling methods you want to keep. The default is to keep <code>"R"</code>, which
refers to samples that were sampled randomly. Available types include
random (R), stratified (S), systematic (N), purposive (P), and special (X).
As of February 17, 2021,
Washington is the only state with a sample type of <code>""</code>, and it was limited
to two special samples of yelloweye rockfish.</p></dd>


<dt>keep_length_type</dt>
<dd><p>A vector of character values specifying the types of
length samples to keep. There is no default value, though users will typically
want to keep <code>c("", "F", "A")</code>, but should also think about using
<code>c("", "F", "A", NA)</code>. Note that types other than those listed below
can be present, especially if you are dealing with a skate.
<code>A</code> is alternate length,
<code>D</code> is dorsal length,
<code>F</code> is fork length,
<code>S</code> is standard length, and
<code>T</code> is total length.</p></dd>


<dt>keep_age_method</dt>
<dd><p>A vector of ageing methods to retain in the data. All fish
aged with methods other than those listed will no longer be considered aged.
A value of <code>NULL</code>, the default, will keep all ageing methods. However,
a vector of <code>c("B", "BB", S", "", NA, 1, 2)</code> will keep all unaged fish and those
that were aged with break and burn and surface reads. You do not really need
to include such a verbose vector of values though because numbers are converted
to appropriate character codes in <a href="getAge.html">getAge</a>. Therefore, something like
<code>c("B", "S")</code> would be sufficient to keep all break and burn and surface reads.</p></dd>


<dt>keep_missing_lengths</dt>
<dd><p><em>Deprecated</em>. Just subset them using
<code>is.na(Pdata[, 'length']) after running </code>cleanPacFIN` if you want to remove
lengths, though there is no need because the package accommodates keeping them in.</p></dd>


<dt>keep_states</dt>
<dd><p>A vector of states that you want to keep, where each state
is defined using a two-letter abbreviation, e.g., <code>WA</code>. The default is to keep
data from all three states, <code>keep_states = c("WA", "OR", "CA")</code>.
Add <code>'UNK'</code> to the vector if you want to keep data not assigned to a state.</p></dd>


<dt>CLEAN</dt>
<dd><p>A logical value used when you want to remove data from the input
data set. The default is <code>TRUE</code>. Where the opposite returns the original
data with additional columns and reports on what would have been removed.</p></dd>


<dt>spp</dt>
<dd><p>A character string giving the species name to
ensure that the methods are species specific. Leave <code>NULL</code>
if generic methods work for your species.
Currently, sablefish is the only species with species-specific code.</p></dd>


<dt>verbose</dt>
<dd><p>A logical specifying if output should be written to the
screen or not. Good for testing and exploring your data but can be turned
off when output indicates information that you already know. The printing
of output to the screen does not affect any of the returned objects. The
default is to always print to the screen, i.e., <code>verbose = TRUE</code>.</p></dd>


<dt>savedir</dt>
<dd><p>A file path to the directory where the results will be saved.
The default is the current working directory.
The path can be relative or absolute.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The input data filtered for desired areas and record types
specified, with added columns</p><ul><li><p>year: initialized from SAMPLE_YEAR<br></p></li>
<li><p>fleet: initialized to 1</p></li>
<li><p>fishery: initialized to 1</p></li>
<li><p>season: initialized to 1.  Change using <a href="getSeason.html">getSeason</a></p></li>
<li><p>state: initialized from SOURCE_AGID.  Change using <a href="getState.html">getState</a></p></li>
<li><p>length: length in mm, where <code>NA</code> indicates length is not available</p></li>
<li><p>lengthcm: floored cm from FORK_LENGTH when available, otherwise FISH_LENGTH</p></li>
<li><p>geargroup: the gear group associated with each <a href="http://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/gr.txt" class="external-link">GRID</a></p></li>
<li><p>weightkg: fish weight in kg from FISH_WEIGHT and FISH_WEIGHT_UNITS</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The original fields in the returned data are left untouched,
with the exception of</p><ul><li><p><code>SEX</code>: modified using <code><a href="https://rdrr.io/pkg/nwfscSurvey/man/codify_sex.html" class="external-link">nwfscSurvey::codify_sex()</a></code> and upon return will
only include character values such that fish with an unidentified sex are
now <code>"U"</code>.</p></li>
<li><p>Age: the best ages to use going forward rather than just the first age read.</p></li>
</ul><div class="section">
<h3 id="clean">CLEAN<a class="anchor" aria-label="anchor" href="#clean"></a></h3>
<p>The data are put through various tests before they are returned
and the results of these tests are stored in the <code>CLEAN</code> column.
Thus, sometimes it is informative to run <code>cleanPacFIN(CLEAN = FALSE)</code>
and use frequency tables to inspect which groups of data will be removed
from the data set when you change the code to be <code>CLEAN = FALSE</code>.
For example, many early length compositions do not have information on
the weight of fish that were sampled, and thus, there is no way to infer
how much the entire sample weighed or how much the tow/trip weighed.
Therefore, these data cannot be expanded and are removed using
<code>CLEAN = TRUE</code>. Some stock assessment authors or even previous
versions of this very code attempted to use adjacent years to inform
weights. The number of assumptions for this was great and state
representatives discouraged inferring data that did not exist.</p>
</div>

<div class="section">
<h3 id="furthermore">Furthermore<a class="anchor" aria-label="anchor" href="#furthermore"></a></h3>
<p>The values created as new columns are for use by other functions in this package.
In particular, <code>fishyr</code> and <code>season</code> are useful if there are multiple
seasons (e.g., winter and summer, as in the petrale sole assessment), and the
year is adjusted so that "winter" occurs in one year, rather than across two.</p>
<p>The <code>fleet</code>, <code>fishery</code>, and <code>state</code> columns are meant for use in
stratifying the data according to the particulars of an assessment.</p>
</div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="getState.html">getState</a>, <a href="getSeason.html">getSeason</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Andi Stephens</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kelli F. Johnson, Chantel R. Wetzel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

