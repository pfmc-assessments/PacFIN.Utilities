<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Write out composition data formatted for Stock Synthesis. — writeComps • PacFIN.Utilities</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Write out composition data formatted for Stock Synthesis. — writeComps"><meta property="og:description" content="Write out composition data to a file, binning the data as specified.

Workflow
PacFIN data should first be stratified using getComps,
before using writeComps.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PacFIN.Utilities</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Write out composition data formatted for Stock Synthesis.</h1>
    
    <div class="hidden name"><code>writeComps.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Write out composition data to a file, binning the data as specified.</p>
<div class="section">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a></h3>
<p>PacFIN data should first be stratified using <code><a href="getComps.html">getComps</a></code>,
before using <code>writeComps</code>.</p>
</div>

    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">writeComps</span><span class="op">(</span></span>
<span>  <span class="va">inComps</span>,</span>
<span>  fname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lbins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxAge <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  month <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  partition <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ageErr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dummybins <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sum1 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>inComps</dt>
<dd><p>A dataframe generated as described in Workflow, above.</p></dd>


<dt>fname</dt>
<dd><p>A filename with the appropriate extension,
used to save the function output to the disk.
For example, <code>LenComps.csv</code> or
<code>file.path(getwd(), "SampleSize.csv")</code>.
Full, relative, or simple paths are allowed because the argument is used as
is, i.e., not redirected to a directory different than <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code>.
Note that various functions within PacFIN.Utilities have different default
values for this input argument.</p></dd>


<dt>abins</dt>
<dd><p>Bins to use for ages.  Default is the data bins.</p></dd>


<dt>lbins</dt>
<dd><p>Bins to use for lengths.  Default is the data bins.</p></dd>


<dt>maxAge</dt>
<dd><p>A numeric value specifying the maximum age of fish that
should be included in the composition data, unless <code>dummybins = TRUE</code>,
then those fish will be included in a plus group which you can investigate
later. Note that <code>maxAge</code> is only used if <code>abins = NULL</code>, otherwise
fish are binned according to user specified bins irregardless of <code>maxAge</code>.</p></dd>


<dt>month</dt>
<dd><p>Month for all observations. Defaults to 7. If input has multiple
seasons, this must be a vector of equal length to the maximum seasons where
the order of months in the vector will be assigned to season in ascending order.
For example, if there  are two seasons and the month = c(1, 7) season 1 will be
assigned to month 1 and season 2 to month 7.</p></dd>


<dt>partition</dt>
<dd><p>Used by Stock Synthesis for length- or age-composition data
where 0 = retained + discarded, 1= discarded, and 2 = retained fish.
The default is to assume that these fish are retained only.
The default was changed in 2020 from a value of 0,
and code should be updated accordingly if you really want 0.</p></dd>


<dt>ageErr</dt>
<dd><p>Defaults to 1.</p></dd>


<dt>dummybins</dt>
<dd><p>A logical value specifying whether data outside of the
lower and upper <code>abins</code> or <code>lbins</code> should be added to dummy bins,
or be placed in the specified bins. Default is <code>TRUE</code>.  Dummy
bins are useful for determining whether the current bin structure
properly captures the data.</p></dd>


<dt>sum1</dt>
<dd><p>A logical value specifying whether to rescale the compositions
to sum to 1 (they will also be rounded to 4 decimal places)</p></dd>


<dt>digits</dt>
<dd><p>Integer indicating the number of decimal places to round
value to (value is passed to <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round()</a></code>). NULL will skip rounding.</p></dd>


<dt>overwrite</dt>
<dd><p>A logical value specifying whether to overwrite an existing
file if the file associated with the input <code>fname</code> already exists.</p></dd>


<dt>verbose</dt>
<dd><p>A logical value specifying if output should be written
to the screen or not. Good for testing and exploring your data but
can be turned off when output indicates errors.
The printing doesn't affect any of the returned objects, instead,
printing makes it easier to see if the data has errors and what was
done to rectify them in the given function.
Sorry, but the default is to always print to the screen,
i.e., <code>verbose = TRUE</code>, so you do not miss out on anything.
This is standard practice for packages in the pfmc-assessments organization.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Appends data to the file given in <code>fname</code>.</p>


<p>Conditionally returns a dataframe if the <code>out</code> argument
specifies the type of composition to return.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The structure of the input dataframe determines whether
<code>writeComps</code> produces age-, length-, or conditional-age-at-length-
composition data.</p>
<p>Four sets of composition data are written to a single file specified
by <code>fname</code>.  These are:</p><ul><li><p>females followed by males</p></li>
<li><p>male data only</p></li>
<li><p>female data only</p></li>
<li><p>males and females recombined as unsexed fish</p></li>
</ul><p>The output file is appended to, rather than overwritten, so you may
want to specify a new filename each time you generate a different
stratification or bin structure, e.g., "out.1.csv", "out.2.csv".</p>
<p>Composition data are raw weights rather than proportions. Stock Synthesis
internally converts these to proportions.  The raw weights should be
examined for anomalies.</p>
<p>To create proportions use <code>prop.table</code> on the columns
containing composition data.</p>
<p>The columns in the output preceeding 'lengthcm' or 'age' are those that
were used in stratifying the data.</p>
<div class="section">
<h3 id="reality-checks">Reality Checks<a class="anchor" aria-label="anchor" href="#reality-checks"></a></h3>

<ul><li><p>Set <code>verbose = TRUE</code> to follow progress</p></li>
<li><p>Use <code>dummybins</code> to evaluate bin structure</p></li>
<li><p>Examine the raw-weight output for anomalies</p></li>
</ul></div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getComps.html">getComps</a></code>, <code><a href="doSexRatio.html">doSexRatio</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Andi Stephens, Chantel Wetzel, Kelli Johnson, Ian Taylor</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kelli F. Johnson, Andi Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

